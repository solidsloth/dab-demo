/*
DROP TABLE IF EXISTS employee;
DROP TABLE IF EXISTS company;
*/

CREATE TABLE IF NOT EXISTS company (
	id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	name TEXT NOT NULL UNIQUE
);

CREATE TABLE IF NOT EXISTS employee (
	id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	first TEXT NOT NULL,
	last TEXT NOT NULL,
	company_id INT NOT NULL,
	CONSTRAINT fk_company FOREIGN KEY (company_id) REFERENCES company(id),
	CONSTRAINT uq_name UNIQUE (first, last)
);

INSERT INTO company (name) VALUES
('RSM'),
('RSM!'),
('RSM!!')
ON CONFLICT DO NOTHING;

INSERT INTO employee (first, last, company_id) VALUES
('Mark', 'Escher', (SELECT id FROM company WHERE name = 'RSM'))
ON CONFLICT DO NOTHING;

SELECT *
FROM company;

SELECT *
FROM employee;
